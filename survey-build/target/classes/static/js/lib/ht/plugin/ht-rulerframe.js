!function(A,b){"use strict";var h="position",p="absolute",r="relative",y="px",O="left",z="right",o="top",w="bottom",C="display",G="none",e="block",P=ht.Default,L=P.getInternal(),j=Math.floor,M=Math.ceil,S=Math.PI,I=null,q=A.parseInt,l=function(r){return r.getContext("2d")},W=function(){return document},s=function(s){return W().createElement(s)},g=function(){return s("canvas")},V=function(k,P,C){k.style.setProperty(P,C,I)},N=function(q,j,J){P.def(ht.widget[q],j,J)},k=function(N,L){N.appendChild(L)},x=function(S,h){S.removeChild(h)},u=function(f,h,n,w){f.addEventListener(h,n,!!w)},K=function(Y,m,$,X){Y.removeEventListener(m,$,!!X)};ht.widget.RulerFrame=function(H){var A=this,$=A._view=L.createView(null,A),E=A.$1k=g(),e=A.$2k=g(),z=A.$3k=g(),l=A.$4k=g();A._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},A._topRulerConfig={visible:!0},A._rightRulerConfig={visible:!1},A._bottomRulerConfig={visible:!1},A._leftRulerConfig={visible:!0},k($,E),k($,z),k($,e),k($,l),V($,h,r),V($,"box-sizing","border-box"),V($,"-moz-box-sizing","border-box"),V(E,h,p),V(e,h,p),V(z,h,p),V(l,h,p),A.$14k=function(){A.$13k=1,A.iv()},A.$15k=function(t){if(A._topRulerConfig.guideVisible||A._rightRulerConfig.guideVisible||A._bottomRulerConfig.guideVisible||A._leftRulerConfig.guideVisible||A._defaultRulerConfig.guideVisible||(A._topRulerConfig.guideTipVisible||A._rightRulerConfig.guideTipVisible||A._bottomRulerConfig.guideTipVisible||A._leftRulerConfig.guideTipVisible||A._defaultRulerConfig.guideTipVisible)&&A._component){var L=$.getBoundingClientRect();A.$16k={x:t.clientX-L.left,y:t.clientY-L.top},A.$5k()}},A.setComponent(H)},N("RulerFrame",b,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(n){var y=this,b=y._component,v=y.getView();if(v){if(y._component=n,y.fp("component",b,n),b){var P=y.getComponentView(b);x(v,P),K(v,"mousemove",y.$15k),y.removeComponentPropertyChangeListener(b,y.$14k)}if(n){var $=y.getComponentView(n);k(v,$),V($,h,p),u(v,"mousemove",y.$15k),y.addComponentPropertyChangeListener(n,y.$14k)}}},addComponentPropertyChangeListener:function(y,N){y&&y.mp&&y.mp(N)},removeComponentPropertyChangeListener:function(g,h){g&&g.ump&&g.ump(h)},getComponentHZoom:function(h){return h&&h.getZoom?h.getZoom():1},getComponentVZoom:function(Y){return Y&&Y.getZoom?Y.getZoom():1},getComponentViewRect:function(D){return D&&D.getViewRect?D.getViewRect():void 0},getComponentView:function(s){return s&&s.getView?s.getView():s},invalidateComponent:function(k){k&&k.iv&&k.iv()},validateComponent:function(y){y&&y.validate&&y.validate()},$7k:function(A,J,$,H,O,U,a,D,f,W,z,u){if(J.visible){var F=this._defaultRulerConfig,M="borderStyle",Y="borderColor",r="borderWidth",R="background",w=J[M]||F[M],q=J[Y]||F[Y],v=J[r]||F[r],Q=J.size!=I?J.size:F.size,_=J[R]||F[R],b=Q+v,i=this.$6k(v,w,q,A,$,O,b,a,D,f,W,z,u);V(A,O,"0px"),U?L.setCanvas(A,H-i,Q):L.setCanvas(A,Q,H-i),V(A,"background",_),V(A,C,e)}else V(A,C,G),V(this.getComponentView(this._component),O,"0px")},$6k:function(s,X,g,K,v,H,R,w,l,I,T,p,d){var $=0;return V(K,v,s+"px "+X+" "+g),V(this.getComponentView(this._component),H,R+y),w?(V(K,l,I+y),$+=I):V(K,l,"0px"),T?(V(K,p,d+y),$+=d):V(K,p,"0px"),$},validateImpl:function(){var t=this,N=t._component,f=t.$1k,q=t.$2k,A=t.$3k,c=t.$4k,M=t._view,s=t._defaultRulerConfig,g=t._topRulerConfig,Z=t._rightRulerConfig,D=t._bottomRulerConfig,i=t._leftRulerConfig,e=s.size;if(M&&N){var P=g.size!=I?g.size:e,X=Z.size!=I?Z.size:e,F=D.size!=I?D.size:e,G=i.size!=I?i.size:e;t.$7k(f,g,"border-bottom",M.offsetWidth,o,!0,i.visible,O,G,Z.visible,z,X),t.$7k(q,Z,"border-left",M.offsetHeight,z,!1,g.visible,o,P,D.visible,w,F),t.$7k(A,D,"border-top",M.offsetWidth,w,!0,i.visible,O,G,Z.visible,z,X),t.$7k(c,i,"border-right",M.offsetHeight,O,!1,g.visible,o,P,D.visible,w,F),t.$13k?delete t.$13k:t.invalidateComponent(N),t.validateComponent(N),t.$5k()}},$5k:function(){function X(F,U,d,q,H,v){if(U.visible){var h=l(F),$=U[k]||a,K=U[w]!=I?U[w]:S,V=U[C]||f,c=U[g]||i,X=U.size!=I?U.size:t,tl=U[P]||y,Uk=U[j]||s,dh=U[O]||D,Tn=U[x]!=I?U[x]:M,qq=U[p]!=I?U[p]:o,Zh=U[W]!=I?U[W]:J,un=U[b]!=I?U[b]:B,_q=U[_]!=I?U[_]:e,ls=U[T]!=I?U[T]:Z,tb=U[N]||zq,Dq=U[A]||kf;K&&($=E[v]=E.$8k(E[v]||$,U[L]||m,U[R]||G,q?Q:Y,Uk)),d.call(E,h,r,n,z,u,X,q?Q:Y,$,V,c,H,tl,dh);var Yl=E.$16k;(Tn||qq)&&Yl&&(q?E.$9k(h,Yl.x,X,tb,Dq,Tn,qq,Zh,un,_q,ls):E.$10k(h,Yl.y,X,tb,Dq,Tn,qq,Zh,un,_q,ls,H))}}var E=this,c=E.$1k,q=E.$2k,K=E.$3k,d=E.$4k,h=E._topRulerConfig,H=E._rightRulerConfig,$=E._bottomRulerConfig,V=E._leftRulerConfig,v=E._defaultRulerConfig,F=E._component,U=E.getComponentViewRect(F),Q=E.getComponentHZoom(F),Y=E.getComponentVZoom(F),r=U.x*Q,z=r+U.width*Q,n=U.y*Y,u=n+U.height*Y,t=E._defaultRulerConfig.size,k="defaultMajorTickSpacing",L="maxPhysicalMajorTickSpacing",R="minPhysicalMajorTickSpacing",w="tickSpacingAdaptable",C="majorTickTextFont",g="majorTickTextColor",P="majorTickColor",O="minorTickColor",x="guideVisible",p="guideTipVisible",W="guideTipBorderColor",b="guideTipTextColor",_="guideTipTextFont",T="guideTipBackground",N="guideColor",A="guideWidth",j="minMajorTickSpacing",a=v[k],m=v[L],G=v[R],S=v[w],f=v[C],i=v[g],y=v[P],s=v[j],D=v[O],M=v[x],o=v[p],J=v[W],B=v[b],e=v[_],Z=v[T],zq=v[N],kf=v[A];E._view&&F&&(X(c,h,E.$11k,!0,!1,"_currentTopMajorTickSpacing"),X(q,H,E.$12k,!1,!0,"_currentRightMajorTickSpacing"),X(K,$,E.$11k,!0,!0,"_currentBottomMajorTickSpacing"),X(d,V,E.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(P,g,U,A,y){return U>P*A?P=j(g/A/y)*y:P*A>g&&(P=M(U/A/y)*y),P},getHTipText:function(o){var c=this,j=c._component,U=0,A=c._view.getBoundingClientRect();return j.lp?U=q(j.lp({clientX:o.x+A.left,clientY:o.y}).x):U-=q(this.getComponentView(j).style.left)||0,U},$9k:function(z,K,S,T,y,p,I,C,l,A,G){var u=this,J=u._component;z.save(),L.translateAndScale(z,0,0,1);var P=K-(q(this.getComponentView(J).style.left)||0),j=0;if(K=u.getHTipText(u.$16k),p&&(z.beginPath(),z.fillStyle=T,z.rect(P,j,y,S),z.fill()),I){z.beginPath(),z.textAlign="center",z.textBaseline="middle",z.font=A;var t=z.measureText(K).width+6;z.fillStyle=G,z.rect(P-t/2,j,t,S),z.fill(),z.strokeStyle=C,z.stroke(),z.beginPath(),z.fillStyle=l,z.fillText(K,P,j+S/2)}z.restore()},getVTipText:function(u){var h=this,t=h._component,l=0,R=h._view.getBoundingClientRect();return t.lp?l=q(t.lp({clientX:u.x,clientY:u.y+R.top}).y):l-=q(this.getComponentView(t).style.top)||0,l},formatScaleText:function(K){return Math.round(K)},$10k:function(p,v,z,G,R,_,O,C,A,r,V,s){var X=this,i=X._component;p.save(),L.translateAndScale(p,0,0,1);var e=z/2,g=v-(q(this.getComponentView(i).style.top)||0);if(v=X.getVTipText(X.$16k),_&&(p.beginPath(),p.fillStyle=G,p.rect(e-z/2,g,z,R),p.fill()),O){p.translate(e,g),p.rotate((s?90:-90)*S/180),p.translate(-e,-g),p.beginPath(),p.textAlign="center",p.textBaseline="middle",p.font=r;var y=p.measureText(v).width+6;p.fillStyle=V,p.rect(e-y/2,g-z/2,y,z),p.fill(),p.strokeStyle=C,p.stroke(),p.fillStyle=A,p.fillText(v,e,g)}p.restore()},$11k:function(N,m,u,s,w,Z,i,W,x,C,k,R,e){N.save(),u=0;var p=m,A=s,h=(p+A)/2;m=0,s=A-p,L.translateAndScale(N,0,0,1);var v=0,Y=0,o=q(Z/2),M=Z-o,S=k?0:o,X=W*i,b=X/10;m-=X,s+=X,N.clearRect(m,0,s-m,Z),N.beginPath(),N.fillStyle=e;var c=j(h/b)*b-p;for(v=c;s>v;v+=b)N.rect(v,u+S,1,M);for(v=c;v>m;v-=b)N.rect(v,u+S,1,M);for(N.fill(),S=k?0:1,N.beginPath(),N.fillStyle=R,c=j(h/X)*X-p,v=c;s>v;v+=X)N.rect(v,u+S,1,Z-1);for(v=c;v>m;v-=X)N.rect(v,u+S,1,Z-1);N.fill();var D=q(/\d+px/.exec(x)[0]),l=(D||10)/2;N.textBaseline="middle",S=k?Z-l-2:l+2,N.beginPath(),N.fillStyle=C,N.font=x;var V=j(h/X)*X/i;for(v=c,Y=V;s>v;v+=X,Y+=W){var t=this.getHScaleText?this.getHScaleText(v):Y;N.fillText(this.formatScaleText(t),v+2,u+S)}for(v=c,Y=V;v>m;v-=X,Y-=W){var t=this.getHScaleText?this.getHScaleText(v):Y;N.fillText(this.formatScaleText(t),v+2,u+S)}N.restore()},$12k:function($,g,O,w,A,e,E,Q,i,W,y,C,R){function D(V,P,R,o,i,U){i=Y.getVScaleText?Y.getVScaleText(R):i,i=Y.formatScaleText(i),$.translate(V+P,R),$.rotate(-o),$.translate(-V-P,-R),$.fillText(i,V+P+(U?2:1),R),$.translate(V+P,R),$.rotate(o),$.translate(-V-P,-R)}$.save(),g=0;var z=O,_=A,f=(z+_)/2;O=0,A=_-z,L.translateAndScale($,0,0,1);var M=0,Y=this,u=0,o=q(e/2),N=e-o,P=y?0:o,m=Q*E,H=m/10;O-=m,A+=m,$.clearRect(g,0,e,A-O),$.beginPath(),$.fillStyle=R;var K=j(f/H)*H-z;for(M=K;A>M;M+=H)$.rect(g+P,M,N,1);for(M=K;M>O;M-=H)$.rect(g+P,M,N,1);for($.fill(),P=y?0:1,$.beginPath(),$.fillStyle=C,K=j(f/m)*m-z,M=K;A>M;M+=m)$.rect(g+P,M,e-1,1);for(M=K;M>O;M-=m)$.rect(g+P,M,e-1,1);$.fill();var V=q(/\d+px/.exec(i)[0]),k=(V||10)/2,B=90*S/180;$.textBaseline="middle",P=y?e-k:k+2,B=y?-B:B,$.beginPath(),$.fillStyle=W,$.font=i;var d=j(f/m)*m/E;for(M=K,u=d;A>M;M+=m,u+=Q)D(g,P,M,B,u,y);for(M=K,u=d;M>O;M-=m,u-=Q)D(g,P,M,B,u,y);$.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var y=this,D=y._component,G=y._view;D&&y.removeComponentPropertyChangeListener(D,y.$14k),G&&(K(G,"mousemove",y.$15k),x(G.parentNode,G),y._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);